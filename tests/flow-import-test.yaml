# Teste demonstrando importação de fluxos reutilizáveis
suite_name: "Teste com Fluxos Importados"

# URL base para todas as requisições
base_url: "https://httpbin.org"

# Importações de fluxos reutilizáveis
imports:
  - name: "auth"
    path: "../flows/auth-flow.yaml"
    variables:
      username: "test_user"
      password: "test_password"
  
  - name: "setup"
    path: "../flows/setup-flow.yaml"
    variables:
      environment: "production"

# Variáveis globais da suíte
variables:
  test_data: "sample_data"

# Etapas específicas desta suíte (executam após os fluxos importados)
steps:
  - name: "Usar dados dos fluxos importados"
    request:
      method: POST
      url: "/post"
      headers:
        Content-Type: "application/json"
        Authorization: "Bearer {{auth.auth_token}}"
        X-Session: "{{setup.session_id}}"
        X-API-Version: "{{setup.api_version}}"
      body:
        data: "{{test_data}}"
        user: "{{auth.user_id}}"
        authenticated: true

    assert:
      status_code: 200

    capture:
      final_result: "body.json.data"

  - name: "Verificação final"
    request:
      method: GET
      url: "/get"
      headers:
        Authorization: "Bearer {{auth_token}}"
        X-Final-Result: "{{final_result}}"

    assert:
      status_code: 200