suite_name: "Iteration Examples - Array and Range"
node_id: "iteration-examples"
description: "Demonstrates iteration functionality with both array and range patterns"
base_url: "{{httpbin_url}}"

metadata:
  priority: "high"
  tags: ["iteration", "examples", "array", "range"]
  estimated_duration_ms: 5000

exports:
  - users_tested
  - range_test_summary

variables:
  test_users:
    - id: 1
      name: "Alice Smith"
      email: "alice@example.com"
      role: "admin"
    - id: 2
      name: "Bob Johnson"
      email: "bob@example.com"
      role: "user"
    - id: 3
      name: "Charlie Brown"
      email: "charlie@example.com"
      role: "moderator"

steps:
  # Example 1: Array Iteration
  - name: "Create user {{item.name}}"
    iterate:
      over: "{{test_users}}"
      as: "item"
    request:
      method: POST
      url: "/post"
      headers:
        Content-Type: "application/json"
      body:
        user_id: "{{item.id}}"
        name: "{{item.name}}"
        email: "{{item.email}}"
        role: "{{item.role}}"
        created_at: "2024-01-01T10:00:00Z"
    assert:
      status_code: 200
      body:
        json:
          user_id:
            equals: "{{item.id}}"
    capture:
      created_user_id: "json.user_id"
      user_creation_timestamp: "json.created_at"

  # Example 2: Simple GET Test
  - name: "Simple GET test"
    request:
      method: GET
      url: "/get"
      params:
        test_param: "test_value"
        timestamp: "1234567890"
    assert:
      status_code: 200
    capture:
      test_param_value: "body.args.test_param"
      timestamp_value: "body.args.timestamp"
      debug_response: "@"
      debug_simple: "status_code"

  # Example 3: Combined Results Summary
  - name: "Generate iteration test summary"
    request:
      method: POST
      url: "/post"
      headers:
        Content-Type: "application/json"
        X-Test-Type: "summary"
      body:
        test_summary:
          array_iterations_completed: 3
          range_iterations_completed: 5
          total_iterations: 8
          test_completed_at: "2024-01-01T12:00:00Z"
        performance_metrics:
          average_response_time: 75
          users_created_count: 3
          load_test_iterations: 5
    assert:
      status_code: 200
      body:
        json:
          test_summary:
            total_iterations:
              equals: 8
          performance_metrics:
            users_created_count:
              equals: 3
    capture:
      users_tested: "json.test_summary.users_created_count"
      range_test_summary: "json.test_summary"