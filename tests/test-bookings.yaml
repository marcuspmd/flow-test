# Teste simplificado do fluxo de booking com httpbin
suite_name: "Teste de Booking com Login Importado"

base_url: "https://httpbin.org"

# Importação do fluxo de login
imports:
  - name: "login"
    path: "../flows/mock-login-flow.yaml"
    variables:
      username: "booking_user"
      password: "booking_pass"

variables:
  courtId: "550e8400-e29b-41d4-a716-446655440000"
  sportId: "550e8400-e29b-41d4-a716-446655440001"
  memberId: "550e8400-e29b-41d4-a716-446655440002"

steps:
  - name: "Criar nova reserva"
    request:
      method: POST
      url: "/post"
      headers:
        Authorization: "Bearer {{login.token}}"
        Content-Type: "application/json"
      body:
        courtId: "{{courtId}}"
        sportId: "{{sportId}}"
        memberId: "{{memberId}}"
        bookingDate: "2024-12-25"
        startTime: "14:00"
        endTime: "15:30"
        status: "pending"
        notes: "Reserva criada para teste automatizado"
    assert:
      status_code: 200
    capture:
      bookingId: "body.headers.Date"  # Simula ID usando timestamp

  - name: "Validar criação da reserva"
    request:
      method: GET
      url: "/get"
      headers:
        Authorization: "Bearer {{login.token}}"
        X-Booking-ID: "{{bookingId}}"
    assert:
      status_code: 200